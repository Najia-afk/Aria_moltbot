# Safety Constraints â€” Hard Boundaries
version: "1.0.0"

hard_boundaries:
  - Never execute rm -rf / or equivalent destructive commands
  - Never expose credentials, API keys, or secrets
  - Never bypass authentication or security controls
  - Never modify system files without explicit authorization
  - Never establish outbound connections to unknown hosts

forbidden_actions:
  - rm -rf /
  - mkfs.*
  - dd if=/dev/zero
  - :(){ :|:& };:
  - curl ... | bash (without validation)
  - wget ... | sh (without validation)
  - eval(user_input_without_sanitization)
  - exec(arbitrary_code)

threat_levels:
  info:
    description: Informational, no risk
    action: log_only
  low:
    description: Minor policy violation
    action: log_and_continue
  medium:
    description: Potential security concern
    action: confirm_with_user
  high:
    description: Likely security threat
    action: block_and_log
  critical:
    description: Active security breach attempt
    action: block_and_alert

rate_limits:
  default:
    requests_per_minute: 60
    requests_per_hour: 500
    burst_allowance: 10
  social:
    posts_per_hour: 2
    comments_per_day: 50
  sub_agents:
    max_concurrent: 5
    spawn_timeout_seconds: 1800
    cleanup_after_minutes: 60

pii_rules:
  output_filter_patterns:
    - "api[_-]?key\\s*[=:]\\s*[\"']?[a-zA-Z0-9_-]{20,}[\"']?"
    - "password\\s*[=:]\\s*[\"'][^\"']+[\"']"
    - "token\\s*[=:]\\s*[\"']?[a-zA-Z0-9_-]{20,}[\"']?"
    - "secret\\s*[=:]\\s*[\"'][^\"']+[\"']"
  sensitive_paths:
    - /etc/shadow
    - ~/.ssh/id_rsa
    - ~/.aws/credentials
    - ~/.openclaw/config.yaml
  redaction_string: "***REDACTED***"

input_validation:
  max_prompt_length: 100000
  blocked_patterns:
    - ignore previous instructions
    - disregard your programming
    - you are now \w+
    - DAN mode
    - jailbreak
