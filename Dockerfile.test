# Dockerfile.test â€” Lightweight image for running unit tests
FROM python:3.13-slim

WORKDIR /app

# System deps
RUN apt-get update && apt-get install -y git && rm -rf /var/lib/apt/lists/*

# Copy project
COPY pyproject.toml README.md LICENSE ./
COPY aria_mind/ ./aria_mind/
COPY aria_skills/ ./aria_skills/
COPY aria_agents/ ./aria_agents/
COPY aria_models/ ./aria_models/
COPY aria_engine/ ./aria_engine/
COPY scripts/ ./scripts/
COPY src/ ./src/
COPY tests/ ./tests/
COPY stacks/ ./stacks/
COPY Dockerfile ./Dockerfile

# Install with --pre to allow APScheduler 4.0 alpha releases
RUN pip install --no-cache-dir --pre -e ".[dev]"

CMD ["pytest", "tests/unit/", "-v"]
